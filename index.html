<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>語料庫 x 爬蟲</title>
    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.7.0/css/theme/night.min.css">
    <link rel="stylesheet" href="plugin/title-footer/title-footer.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/tomorrow-night-bright.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
    <style>
    section img {
      border: none !important;
      background: none !important;
      box-shadow: none !important;
    }
    pre {
      box-shadow: none !important;
    }
    .reveal pre code {
      border-radius: 10px;
      opacity: 0.7;
    }
    .line {
      display: block;
    }
    .line.focus {
      background: rgba(255, 255, 0, 0.4);
      border-radius: 3px;
    }
    pre {
      counter-increment: listing 0;
    }
    pre > code:not(.lang-bash) > .line:before {
      counter-increment: listing;
      content: counter(listing, decimal-leading-zero);
      color: rgba(182, 182, 182, 0.4);
      display: inline-block;
      width: 2em;
      padding-left: 0;
      margin-left: 0;
      text-align: left;
    }
    .fragment.current-visible.visible:not(.current-fragment) {
     display: none;
      height:0px;
      line-height: 0px;
      font-size: 0px;
    }
    .btn-copy {
      position: absolute;
      top: 5px;
      right: 5px;
      z-index: 100;
      cursor: pointer;
      opacity: 0.3;
    }
    .btn-copy:before {
      font-family: "Font Awesome 5 Free";
      font-weight: 900;
      content: "\f0c5";
    }
    .btn-copy:hover {
      opacity: 1;
    }
    #topmsg {
      position: absolute;
      text-align: center;
      top: 0;
      padding-top: 5px;
      width: 100%;
      height: 20px;
      z-index:99999;
      background: rgba(243,215,172, 0.5);
      opacity: 0;
      -webkit-transition: all 0.5s ease-in-out;
      -moz-transition: all 0.5s ease-in-out;
      -ms-transition: all 0.5s ease-in-out;
      -o-transition: all 0.5s ease-in-out;
      transition: all 0.5s ease-in-out;
    }
    </style>
  </head>
  <body>
    <div id="topmsg">已複製!</div>
    <div class="reveal">
      <div class="slides">

        <section data-markdown>
          <textarea data-template>
# 語料庫 x 爬蟲

<a target="_blank" href="https://aji.tw">
![logo](https://aji.tw/static_all/img/logo.png) <!-- .elements width="60px" -->
</a>

<canvas id="qr"></canvas>
          </textarea>
        </section>

        <section>
          <section data-markdown>
            <textarea data-template>
## 什麼蟲？能吃嗎？
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### 爬蟲是什麼？

> 網路爬蟲...是一種用來自動瀏覽全球資訊網的網路機器人。其目的一般為編纂網路索引。 網路搜尋引擎等站點通過爬蟲軟體更新自身的網站內容或其對其他網站的索引。網路爬蟲可以將自己所存取的頁面儲存下來，以便搜尋引擎事後生成索引供用戶搜尋。 (來源：[維基百科](https://zh.wikipedia.org/zh-tw/網路爬蟲))
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
簡單講就是...

把別人的東西變成自己的東西 <!-- .elements class="fragment" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### 全世界最大的爬蟲公司
![google](https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg) <!-- .elements class="fragment" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
              這些公司也都是
              <div style="background-color:rgba(255, 255, 255, 0.6);border-radius:5px">
![Bing](https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/Bing_logo_%282016%29.svg/1000px-Bing_logo_%282016%29.svg.png)  <!-- .elements width="200px" -->
![Yahoo](https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Yahoo%21_logo.svg/512px-Yahoo%21_logo.svg.png) <!-- .elements width="200px" -->
![DuckDuckGo](https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/DuckDuckGo_logo_and_wordmark_%282014-present%29.svg/250px-DuckDuckGo_logo_and_wordmark_%282014-present%29.svg.png) <!-- .elements width="200px" -->
![Baiduspider](https://upload.wikimedia.org/wikipedia/en/thumb/f/f4/Baidu.svg/231px-Baidu.svg.png) <!-- .elements width="200px" -->
![Sogou](https://upload.wikimedia.org/wikipedia/en/3/38/Sogou_logo.png) <!-- .elements width="200px" -->
![Facebook](https://upload.wikimedia.org/wikipedia/commons/c/cd/Facebook_logo_%28square%29.png) <!-- .elements width="50px" -->
![Alexa](https://upload.wikimedia.org/wikipedia/commons/4/4a/Amazon_Alexa_logo.svg) <!-- .elements width="250px" -->
              </div>
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### `robots.txt` 

> robots.txt 是一種存放於網站根目錄下的文字檔案，它通常告訴網路搜尋引擎此網站中的哪些內容是不應被搜尋引擎取得的，哪些是可以被取得的。[(wiki)](https://zh.wikipedia.org/zh-tw/Robots.txt)

<i class="fas fa-bullhorn"></i> 
不是規範，只是約定俗成
            </textarea>
          </section>
        </section>

        <section>
          <section data-markdown>
            <textarea data-template>
## 爬蟲攻防戰 
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### 反爬蟲

+ IP 黑名單 
    - （無限）轉址
    - 404 Not Found
    - 503 Service Unavailable
    - 504 Gateway Timeout
+ 程式碼混淆 
+ javascript 偵測 
+ 文字圖形化 
+ 圖形驗證碼 
+ No CAPTCHA reCAPTCHA 
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### 反反爬蟲

| 道高一尺               |     魔高一丈              |
| ---------------------- | ------------------------- |
| IP 黑名單              | 代理伺服器 手機網路       |
| 程式碼混淆             |  逆向工程                 | 
| javascript 偵測        | 模擬 javascript           |
| 文字圖形化             | 光學字元辨識              |
| 圖形驗證碼             | 人工智慧                  | 
| No CAPTCHA reCAPTCHA   | 工人智慧                  |
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### 反反反爬蟲

+ 反反反反爬蟲 <!-- .elements class="fragment"> -->
+ 反反反反反爬蟲 <!-- .elements class="fragment"> -->
+ 反反反反反反爬蟲 <!-- .elements class="fragment"> -->
+ 反反反反反反反爬蟲 <!-- .elements class="fragment"> -->
+ 反反反反反反反反爬蟲 <!-- .elements class="fragment"> -->
+ 反反反反反反反反反爬蟲 <!-- .elements class="fragment"> -->
+ 反反反反反反反反反反爬蟲 <!-- .elements class="fragment"> -->
            </textarea>
          </section>
        </section>

        <section> 
          <section data-markdown>
            <textarea data-template>
## 工欲善其事 
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### <i class="fab fa-python"></i> Python

+ 發行版 - [官方版本](https://www.python.org) 
+ 版本 - `3.6+`
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
###  瀏覽器 

<i class="fab fa-chrome"></i> Google Chrome

            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### PIP 套件

+ [`requests`](http://docs.python-requests.org/en/master/)
+ [`BeautifulSoup`](https://www.crummy.com/software/BeautifulSoup/bs4/doc/)

安裝
```bash
pip install -U requests
pip install -U beautifulsoup4
```
            </textarea>
          </section>
        </section>

        <section>
          <section data-markdown>
            <textarea data-template>
## 基礎知識 
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
請先準備一個測試用的 web server  
<i class="fas fa-code"></i> 建立 `server.py`
```python
from http.server import SimpleHTTPRequestHandler
from socketserver import TCPServer

class WebServer(SimpleHTTPRequestHandler):

    def do_GET(self):
        print(self.headers)
        super().do_GET()

print('press CTRL+C to stop...')
TCPServer(("127.0.0.1", 8000), WebServer).serve_forever()
```

<i class="fas fa-code"></i> 在終端機執行

```bash
python server.py
```
            </textarea>
          </section>
          <section data-markdown class="extra_layer">
            <textarea data-template>
### 網頁技術 

|        |                           |
| ------ | ------------------------- |
| HTML   | HyperText Markup Language |
| DOM    | Dom Object Model          |
| CSS    | Cascading Style Sheets    |
| JS     | javascript                |
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### HTTP 標頭 (headers) 

```text
Accept: text/html,application/xhtml+xm…plication/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.5
Connection: keep-alive
Cookie: __cfduid=df5348086ef38be7990d6…d=GA1.2.1406394816.1522116242
Host: static.tutsplus.com
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linu…) Gecko/20100101 Firefox/59.0
```
User-Agent 代表的是瀏覽器的資訊 <!-- .elements class="fragment" data-code-focus="7" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 查看 `User-Agent` 

```python 
from requests import Session

session = Session()
print(session.headers['user-agent'])
session.get('http://127.0.0.1:8000')
```

預設為 python-requests/2.19.1 <!-- .element: class="fragment current-visible" data-code-focus="4" -->

發送請求至 web server，看到一樣的 User-Agent <!-- .element: class="fragment current-visible" data-code-focus="5" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 更改 `User-Agent` 

```python 
google_ua = 'Googlebot/2.1 (+http://www.google.com/bot.html)'
session.headers['User-Agent'] = google_ua
session.get('http://127.0.0.1:8000')
```
這是 Google 常用的 User-Agent <!-- .element: class="fragment current-visible" data-code-focus="1" -->

修改預設 User-Agent <!-- .element: class="fragment current-visible" data-code-focus="2" -->

從 web server 查看是否成功 <!-- .element: class="fragment current-visible" data-code-focus="3" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### [HTTP 請求方法](https://developer.mozilla.org/zh-TW/docs/Web/HTTP/Methods)

+ GET <!-- .element: class="fragment highlight-red grow" -->
+ POST <!-- .element: class="fragment highlight-red grow" -->
+ HEAD 
+ PUT
+ DELETE
+ CONNECT
+ OPTIONS
+ TRACE
+ PATCH
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 發送請求 
```python 
session.get('http://127.0.0.1')
session.post('http://127.0.0.1')
```
這就是一個 GET 的請求 <!-- .element: class="fragment current-visible" data-code-focus="1" -->

這就是一個 POST 的請求 <!-- .element: class="fragment current-visible" data-code-focus="2" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### [HTTP 狀態碼](https://developer.mozilla.org/zh-TW/docs/Web/HTTP/Status)
+ `1xx` 資訊回應
+ `2xx` 成功為應
+ `3xx` 重定向訊息
+ `4xx` 用戶端錯誤回應
+ `5xx` 伺服器端錯誤回應
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 查看狀態碼

`GET`
```python 
response = session.get('http://127.0.0.1')
print(response.status_code)
```

`POST`
```python
response = session.post('http://127.0.0.1')
print(response.status_code)
```
得到 200，代表成功回應 <!-- .element: class="fragment current-visible" data-code-focus="2" -->

得到 501，代表伺服器沒有實作這個請求方法 <!-- .element: class="fragment current-visible" data-code-focus="4" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### 網頁元素定位 

| CSS 選擇器     | 意義                                 
| -------------  |----------------------
| `*         `   | 任一元素
| `p         `   | `p` 標籤 (tag)
| `p > *     `   | `p` 下一階的任一元素
| `#foo      `   | `id="foo"` 
| `.bar      `   | `class="bar"` 
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 請在剛剛建立 `server.py` 的同一個資料夾下，建立 `demo.html`   

```html
<html>
  <div id="foo">hello</div>
  <p>
    <span>hello</span>
  </p>
  <div class="bar">bar1</div>
  <div class="bar">bar2</div>
  <div class="bar">bar3</div>
</html>
```
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 發送 `GET` 請求至 `demo.html`
```python
response = session.get('http://127.0.0.1:8000/demo.html')
html = response.text
```

<i class="fas fa-code"></i> 用 `BeautifulSoup` 將 `html` 轉為 `DOM`
```python
from bs4 import BeautifulSoup
dom = BeautifulSoup(html)
```
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 找出 `hello`
```python
dom.select('#foo')[0].text
```

<i class="fas fa-code"></i> 找出 `world`
```python
dom.select('p > span')[0].text
dom.select('p span')[0].text
dom.select('p *')[0].text
```
<small>此結構中，這3種選擇方式是一樣的</small>

<i class="fas fa-code"></i> 找出 `bar1` `bar2` `bar3`
```python
[i.text for i in dom.select('div.bar')]
[i.text for i in dom.select('.bar')]

```
<small>此結構中，這2種選擇方式是一樣的</small>
            </textarea>
          </section>
        </section>

        <section>
          <section data-markdown>
            <textarea data-template>
## 實戰

![appledaily](https://img.appledaily.com.tw/pay/img/tw_applelogo_v7.png)
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### 流程
0. 蒐集 **即時 > 最新** 所有當日新聞連結
0. 蒐集所有連結的內容並轉存為結構化的資料
0. 將結構化的資料輸出成檔案
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 事前準備

```python 
from datetime import datetime
from time import sleep
from random import random

from requests import Session
from bs4 import BeautifulSoup

session = Session()
session.headers['User-Agent'] = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36'
```

import 必要套件 <!-- .element: class="fragment current-visible" data-code-focus="1-6" -->

處理文章時間的函式 <!-- .element: class="fragment current-visible" data-code-focus="1" -->

讓程式暫停的函式 <!-- .element: class="fragment current-visible" data-code-focus="2" -->

隨機產生0到1之間的小數 <!-- .element: class="fragment current-visible" data-code-focus="3" -->

記得更改 User-Agent <!-- .element: class="fragment current-visible" data-code-focus="9" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### 蒐集連結

<i class="fas fa-code"></i>  設定變數

```python
base_url = 'https://tw.appledaily.com/new/realtime/{page}'
page = 1
links = []
current_date = datetime.now().date()
```
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 遞迴找出所有連結
```python
while True:
    url = base_url.format(page=page)
    response = session.get(url)
    print(f'已經爬到第{page}頁面')
    dom = BeautifulSoup(response.text)
    raw_time = dom.select('h1.dddd > time')[0].text
    date = datetime.strptime(raw_time, '%Y / %m / %d').date()
    if date < current_date:
        break
    elements = dom.select('h1.dddd + ul.rtddd > li')
    for element in elements:
        link = element.select('a')[0]['href'] 
        links.append(link)
    sleep(random() * 5)
    page += 1
```

while 迴圈 <!-- .element: class="fragment current-visible" data-code-focus="1" -->

組成 url  <!-- .element: class="fragment current-visible" data-code-focus="2" -->

發送 GET 請求  <!-- .element: class="fragment current-visible" data-code-focus="3" -->

在螢幕上顯示爬到的頁面  <!-- .element: class="fragment current-visible" data-code-focus="4" -->

轉換成 DOM  <!-- .element: class="fragment current-visible" data-code-focus="5" -->

取出日期  <!-- .element: class="fragment current-visible" data-code-focus="6" -->

轉換成 datetime 物件  <!-- .element: class="fragment current-visible" data-code-focus="7" -->

如果顯示日期小於本日，則跳出迴圈 <!-- .element: class="fragment current-visible" data-code-focus="8-9" -->

取出所有文章列表 <!-- .element: class="fragment current-visible" data-code-focus="10" -->

遍歷所有文章列表 <!-- .element: class="fragment current-visible" data-code-focus="11" -->

取出文章url <!-- .element: class="fragment current-visible" data-code-focus="12" -->

隨機等待幾秒，以免變成暴力攻擊 <!-- .element: class="fragment current-visible" data-code-focus="14" -->

迴圈結束，page 加 1 <!-- .element: class="fragment current-visible" data-code-focus="15" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### 蒐集內容

<i class="fas fa-code"></i> 取得所有連結內容

```python 
htmls = []
for num, link in enumerate(links):
    print(f'還剩下{len(links) - num}個頁面')
    response = session.get(link)
    htmls.append(response.text)
    sleep(random() * 5)
```

建立 list 物件，用以儲存網頁原始碼 <!-- .element: class="fragment current-visible" data-code-focus="1" -->

遍歷每一個連結 <!-- .element: class="fragment current-visible" data-code-focus="2" -->

顯示還剩下多少個連結沒有拜訪 <!-- .element: class="fragment current-visible" data-code-focus="3" -->

送出 GET 請求 <!-- .element: class="fragment current-visible" data-code-focus="4" -->

儲存網頁原始碼 <!-- .element: class="fragment current-visible" data-code-focus="5" -->

隨機等待幾秒，以免變成暴力攻擊 <!-- .element: class="fragment current-visible" data-code-focus="6" -->

            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 元素定位與將資料結構化

```python
posts = []
for html in htmls:
    dom = BeautifulSoup(response.text)
    title = dom.select('article.ndArticle_leftColumn h1')[0].text
    created_time = dom.select('article.ndArticle_leftColumn div.ndArticle_creat')[0].text
    category = dom.select('nav div.ndgTag a.current')[0].text
    content = dom.select('article.ndArticle_content p')[0].text
    post = dict(title=title, created_time=created_time, category=category, content=content)
    posts.append(post)
```

建立 list 物件以存放結構化資料 <!-- .element: class="fragment current-visible" data-code-focus="1" -->

遍歷所有網頁原始碼 <!-- .element: class="fragment current-visible" data-code-focus="2" -->

轉換成 DOM <!-- .element: class="fragment current-visible" data-code-focus="3" -->

取出新聞標題 <!-- .element: class="fragment current-visible" data-code-focus="4" -->

取出新聞時間 <!-- .element: class="fragment current-visible" data-code-focus="5" -->

取出新聞分類 <!-- .element: class="fragment current-visible" data-code-focus="6" -->

取出新聞內容 <!-- .element: class="fragment current-visible" data-code-focus="7" -->

存成 dict 型別 <!-- .element: class="fragment current-visible" data-code-focus="8" -->

將結構化資料存進 list <!-- .element: class="fragment current-visible" data-code-focus="9" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
### 輸出檔案

<i class="fas fa-code"></i> 儲存成 `JSON` 格式

```python
import json

with open('appledaily.json', 'w') as f:
    json.dump(posts, f)
```

import json 模組 <!-- .element: class="fragment current-visible" data-code-focus="1" -->

建立名為 appledaily.json 的文件 <!-- .element: class="fragment current-visible" data-code-focus="3" -->

將資料寫入文件 <!-- .element: class="fragment current-visible" data-code-focus="4" -->
            </textarea>
          </section>
          <section data-markdown>
            <textarea data-template>
<i class="fas fa-code"></i> 完整的程式碼

```python
from datetime import datetime
from time import sleep
from random import random
import json

from requests import Session
from bs4 import BeautifulSoup

session = Session()
session.headers['User-Agent'] = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36'


base_url = 'https://tw.appledaily.com/new/realtime/{page}'
page = 1
links = []
current_date = datetime.now().date()

while True:
    url = base_url.format(page=page)
    response = session.get(url)
    print(f'已經爬到第{page}頁')
    dom = BeautifulSoup(response.text)
    raw_time = dom.select('h1.dddd > time')[0].text
    date = datetime.strptime(raw_time, '%Y / %m / %d').date()
    if date < current_date:
        break
    elements = dom.select('h1.dddd + ul.rtddd > li')
    for element in elements:
        link = element.select('a')[0]['href']
        links.append(link)
    sleep(random() * 5)
    page += 1

base_url = 'https://tw.appledaily.com/new/realtime/{page}'
page = 1
links = []
current_date = datetime.now().date()

while True:
    url = base_url.format(page=page)
    response = session.get(url)
    print(f'已經爬到第{page}頁面')
    dom = BeautifulSoup(response.text)
    raw_time = dom.select('h1.dddd > time')[0].text
    date = datetime.strptime(raw_time, '%Y / %m / %d').date()
    if date < current_date:
        break
    elements = dom.select('h1.dddd + ul.rtddd > li')
    for element in elements:
        link = element.select('a')[0]['href']
        links.append(link)
    sleep(random() * 5)
    page += 1

htmls = []
for num, link in enumerate(links):
    print(f'還剩下{len(links) - num}個頁面')
    response = session.get(link)
    htmls.append(response.text)
    sleep(random() * 5)

posts = []
for html in htmls:
    dom = BeautifulSoup(response.text)
    title = dom.select('article.ndArticle_leftColumn h1')[0].text
    created_time = dom.select('article.ndArticle_leftColumn div.ndArticle_creat')[0].text
    category = dom.select('nav div.ndgTag a.current')[0].text
    content = dom.select('article.ndArticle_content p')[0].text
    post = dict(title=title, created_time=created_time, category=category, content=content)
    posts.append(post)

with open('appledaily.json', 'w') as f:
    json.dump(posts, f)
```
            </textarea>
          </section>
        </section>

      </div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
    <script type="text/javascript">
    (function(){
      var tId = setInterval(function() {
        if (document.readyState == "complete") onComplete()
      }, 11);
      function onComplete(){
        clearInterval(tId);    
        var qr = new QRious({
          element: document.getElementById('qr'),
          value: window.location.href,
          size: 180,
        });
        // Clipboard.js
        var eles = document.getElementsByTagName("code");
        var max = eles.length;
        for (var i=0; i<max; i++) {
          if (eles[i].parentNode.tagName == "PRE") {
            eles[i].setAttribute("id", "_code" + i)
            var btn = document.createElement("div");
            btn.className = "btn-copy"; 
            btn.setAttribute("data-clipboard-target", "#_code" + i);
            btn.setAttribute("data-interactive", true);
            eles[i].parentNode.prepend(btn);
          }
        };
        var clipboard = new ClipboardJS('.btn-copy');
        clipboard.on('success', function(e) {
          console.log(e);
          document.getElementById("topmsg").style.opacity = 1;
          setTimeout(function() {
            document.getElementById("topmsg").style.opacity = 0;
          }, 500);
          e.clearSelection();
        });
        clipboard.on('error', function(e) {
          console.log(e);
        });
      };
    })()
    </script>
    <script>
      Reveal.initialize({
        history: true,
        slideNumber: true,
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          { src: 'plugin/notes/notes.js', async: true },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'https://cdn.jsdelivr.net/npm/reveal-code-focus@1.0.0/reveal-code-focus.min.js', async: true, callback: function() { RevealCodeFocus() } },
          { src: 'plugin/reveal.js-menu/menu.js'},
          { src: 'https://cdn.rawgit.com/e-gor/Reveal.js-Title-Footer/master/plugin/title-footer/title-footer.js', async: true, callback: function() { title_footer.initialize(); } }
        ],
        parallaxBackgroundImage: './img/red-purple-abstract-w1.jpg',
        parallaxBackgroundSize: '2500px',
        parallaxBackgroundHorizontal: 90,
        parallaxBackgroundVertical: 45,
        menu: {
          hideMissingTitles: true,
          numbers: true,
          markers: true,
          themes: false,
          transitions: false
        }
      });
    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-91846715-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
